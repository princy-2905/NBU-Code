

create table nbu.stg_experian_tradeline_segment
(
customer_id varchar(max), 
acct_key varchar(max), 
account_nb varchar(max), 
m_sub_id varchar(max), 
acct_type_cd varchar(max), 
open_dt varchar(max), 
actual_payment_am varchar(max), 
asset_class_cd varchar(max), 
balance_am varchar(max), 
balance_dt varchar(max), 
total_write_off_am_4in varchar(max), 
principal_write_off_am_4in varchar(max), 
tanure varchar(max), 
emi varchar(max), 
account_desc_cd varchar(max), 
interest_rate varchar(max), 
settled_am_4in varchar(max), 
start_pymt_dt varchar(max), 
last_reporting_pymt_dt varchar(max), 
bank_name varchar(max), 
closed_dt varchar(max), 
credit_limit_am varchar(max), 
days_past_due varchar(max), 
dflt_status_dt varchar(max), 
last_payment_dt varchar(max), 
orig_loan_am varchar(max), 
past_due_am varchar(max), 
payment_history_grid varchar(max), 
suit_filed_willful_dflt varchar(max), 
written_off_and_settled_status varchar(max), 
write_off_status_dt varchar(max), 
responsibility_cd varchar(max), 
portfolio_rating_type_cd varchar(max), 
write_off_am varchar(max), 
actual_payment_am_01 varchar(max), 
actual_payment_am_02 varchar(max), 
actual_payment_am_03 varchar(max), 
actual_payment_am_04 varchar(max), 
actual_payment_am_05 varchar(max), 
actual_payment_am_06 varchar(max), 
actual_payment_am_07 varchar(max), 
actual_payment_am_08 varchar(max), 
actual_payment_am_09 varchar(max), 
actual_payment_am_10 varchar(max), 
actual_payment_am_11 varchar(max), 
actual_payment_am_12 varchar(max), 
actual_payment_am_13 varchar(max), 
actual_payment_am_14 varchar(max), 
actual_payment_am_15 varchar(max), 
actual_payment_am_16 varchar(max), 
actual_payment_am_17 varchar(max), 
actual_payment_am_18 varchar(max), 
actual_payment_am_19 varchar(max), 
actual_payment_am_20 varchar(max), 
actual_payment_am_21 varchar(max), 
actual_payment_am_22 varchar(max), 
actual_payment_am_23 varchar(max), 
actual_payment_am_24 varchar(max), 
actual_payment_am_25 varchar(max), 
actual_payment_am_26 varchar(max), 
actual_payment_am_27 varchar(max), 
actual_payment_am_28 varchar(max), 
actual_payment_am_29 varchar(max), 
actual_payment_am_30 varchar(max), 
actual_payment_am_31 varchar(max), 
actual_payment_am_32 varchar(max), 
actual_payment_am_33 varchar(max), 
actual_payment_am_34 varchar(max), 
actual_payment_am_35 varchar(max), 
actual_payment_am_36 varchar(max), 
balance_am_01 varchar(max), 
balance_am_02 varchar(max), 
balance_am_03 varchar(max), 
balance_am_04 varchar(max), 
balance_am_05 varchar(max), 
balance_am_06 varchar(max), 
balance_am_07 varchar(max), 
balance_am_08 varchar(max), 
balance_am_09 varchar(max), 
balance_am_10 varchar(max), 
balance_am_11 varchar(max), 
balance_am_12 varchar(max), 
balance_am_13 varchar(max), 
balance_am_14 varchar(max), 
balance_am_15 varchar(max), 
balance_am_16 varchar(max), 
balance_am_17 varchar(max), 
balance_am_18 varchar(max), 
balance_am_19 varchar(max), 
balance_am_20 varchar(max), 
balance_am_21 varchar(max), 
balance_am_22 varchar(max), 
balance_am_23 varchar(max), 
balance_am_24 varchar(max), 
balance_am_25 varchar(max), 
balance_am_26 varchar(max), 
balance_am_27 varchar(max), 
balance_am_28 varchar(max), 
balance_am_29 varchar(max), 
balance_am_30 varchar(max), 
balance_am_31 varchar(max), 
balance_am_32 varchar(max), 
balance_am_33 varchar(max), 
balance_am_34 varchar(max), 
balance_am_35 varchar(max), 
balance_am_36 varchar(max), 
credit_limit_am_01 varchar(max), 
credit_limit_am_02 varchar(max), 
credit_limit_am_03 varchar(max), 
credit_limit_am_04 varchar(max), 
credit_limit_am_05 varchar(max), 
credit_limit_am_06 varchar(max), 
credit_limit_am_07 varchar(max), 
credit_limit_am_08 varchar(max), 
credit_limit_am_09 varchar(max), 
credit_limit_am_10 varchar(max), 
credit_limit_am_11 varchar(max), 
credit_limit_am_12 varchar(max), 
credit_limit_am_13 varchar(max), 
credit_limit_am_14 varchar(max), 
credit_limit_am_15 varchar(max), 
credit_limit_am_16 varchar(max), 
credit_limit_am_17 varchar(max), 
credit_limit_am_18 varchar(max), 
credit_limit_am_19 varchar(max), 
credit_limit_am_20 varchar(max), 
credit_limit_am_21 varchar(max), 
credit_limit_am_22 varchar(max), 
credit_limit_am_23 varchar(max), 
credit_limit_am_24 varchar(max), 
credit_limit_am_25 varchar(max), 
credit_limit_am_26 varchar(max), 
credit_limit_am_27 varchar(max), 
credit_limit_am_28 varchar(max), 
credit_limit_am_29 varchar(max), 
credit_limit_am_30 varchar(max), 
credit_limit_am_31 varchar(max), 
credit_limit_am_32 varchar(max), 
credit_limit_am_33 varchar(max), 
credit_limit_am_34 varchar(max), 
credit_limit_am_35 varchar(max), 
credit_limit_am_36 varchar(max), 
past_due_am_01 varchar(max), 
past_due_am_02 varchar(max), 
past_due_am_03 varchar(max), 
past_due_am_04 varchar(max), 
past_due_am_05 varchar(max), 
past_due_am_06 varchar(max), 
past_due_am_07 varchar(max), 
past_due_am_08 varchar(max), 
past_due_am_09 varchar(max), 
past_due_am_10 varchar(max), 
past_due_am_11 varchar(max), 
past_due_am_12 varchar(max), 
past_due_am_13 varchar(max), 
past_due_am_14 varchar(max), 
past_due_am_15 varchar(max), 
past_due_am_16 varchar(max), 
past_due_am_17 varchar(max), 
past_due_am_18 varchar(max), 
past_due_am_19 varchar(max), 
past_due_am_20 varchar(max), 
past_due_am_21 varchar(max), 
past_due_am_22 varchar(max), 
past_due_am_23 varchar(max), 
past_due_am_24 varchar(max), 
past_due_am_25 varchar(max), 
past_due_am_26 varchar(max), 
past_due_am_27 varchar(max), 
past_due_am_28 varchar(max), 
past_due_am_29 varchar(max), 
past_due_am_30 varchar(max), 
past_due_am_31 varchar(max), 
past_due_am_32 varchar(max), 
past_due_am_33 varchar(max), 
past_due_am_34 varchar(max), 
past_due_am_35 varchar(max), 
past_due_am_36 varchar(max), 
payment_rating_cd_01 varchar(max), 
payment_rating_cd_02 varchar(max), 
payment_rating_cd_03 varchar(max), 
payment_rating_cd_04 varchar(max), 
payment_rating_cd_05 varchar(max), 
payment_rating_cd_06 varchar(max), 
payment_rating_cd_07 varchar(max), 
payment_rating_cd_08 varchar(max), 
payment_rating_cd_09 varchar(max), 
payment_rating_cd_10 varchar(max), 
payment_rating_cd_11 varchar(max), 
payment_rating_cd_12 varchar(max), 
payment_rating_cd_13 varchar(max), 
payment_rating_cd_14 varchar(max), 
payment_rating_cd_15 varchar(max), 
payment_rating_cd_16 varchar(max), 
payment_rating_cd_17 varchar(max), 
payment_rating_cd_18 varchar(max), 
payment_rating_cd_19 varchar(max), 
payment_rating_cd_20 varchar(max), 
payment_rating_cd_21 varchar(max), 
payment_rating_cd_22 varchar(max), 
payment_rating_cd_23 varchar(max), 
payment_rating_cd_24 varchar(max), 
payment_rating_cd_25 varchar(max), 
payment_rating_cd_26 varchar(max), 
payment_rating_cd_27 varchar(max), 
payment_rating_cd_28 varchar(max), 
payment_rating_cd_29 varchar(max), 
payment_rating_cd_30 varchar(max), 
payment_rating_cd_31 varchar(max), 
payment_rating_cd_32 varchar(max), 
payment_rating_cd_33 varchar(max), 
payment_rating_cd_34 varchar(max), 
payment_rating_cd_35 varchar(max), 
payment_rating_cd_36 varchar(max), 
days_past_due_01 varchar(max), 
days_past_due_02 varchar(max), 
days_past_due_03 varchar(max), 
days_past_due_04 varchar(max), 
days_past_due_05 varchar(max), 
days_past_due_06 varchar(max), 
days_past_due_07 varchar(max), 
days_past_due_08 varchar(max), 
days_past_due_09 varchar(max), 
days_past_due_10 varchar(max), 
days_past_due_11 varchar(max), 
days_past_due_12 varchar(max), 
days_past_due_13 varchar(max), 
days_past_due_14 varchar(max), 
days_past_due_15 varchar(max), 
days_past_due_16 varchar(max), 
days_past_due_17 varchar(max), 
days_past_due_18 varchar(max), 
days_past_due_19 varchar(max), 
days_past_due_20 varchar(max), 
days_past_due_21 varchar(max), 
days_past_due_22 varchar(max), 
days_past_due_23 varchar(max), 
days_past_due_24 varchar(max), 
days_past_due_25 varchar(max), 
days_past_due_26 varchar(max), 
days_past_due_27 varchar(max), 
days_past_due_28 varchar(max), 
days_past_due_29 varchar(max), 
days_past_due_30 varchar(max), 
days_past_due_31 varchar(max), 
days_past_due_32 varchar(max), 
days_past_due_33 varchar(max), 
days_past_due_34 varchar(max), 
days_past_due_35 varchar(max), 
days_past_due_36 varchar(max)
)




TRUNCATE table "digital-revenue".nbu.stg_experian_tradeline_segment

COPY "digital-revenue".nbu.stg_experian_tradeline_segment FROM 's3://angelone-nbu/experian/scrub_2023-12-05/cinp3694ange_06122023_070754AM_AngelOne_Experian_Base_2023-12-05_RPT_AR_ENQ_SCORE_CP/tradeline.txt' IAM_ROLE 'arn:aws:iam::555445901246:role/analytics-redshift-glue-role' FORMAT AS CSV DELIMITER '|' QUOTE '"' IGNOREHEADER 1 MAXERROR AS 1 emptyasnull BLANKSASNULL REGION AS 'ap-south-1'

Drop table  "digital-revenue".nbu.experian_tradeline_segment;
create table "digital-revenue".nbu.experian_tradeline_segment
(
id INT IDENTITY(1,1),
response_id varchar(255),
customer_id bigint, 
acct_key bigint, 
account_nb varchar(50), 
m_sub_id varchar(10), 
acct_type_cd integer, 
open_dt date, 
actual_payment_am integer, 
asset_class_cd varchar(10), 
balance_am integer, 
balance_dt date, 
total_write_off_am_4in bigint, 
principal_write_off_am_4in bigint, 
tanure bigint, 
emi bigint, 
account_desc_cd bigint, 
interest_rate decimal(15,5), 
settled_am_4in bigint, 
start_pymt_dt date, 
last_reporting_pymt_dt date, 
bank_name varchar(max), 
closed_dt date, 
credit_limit_am bigint, 
days_past_due integer, 
dflt_status_dt date, 
last_payment_dt date, 
orig_loan_am bigint, 
past_due_am bigint, 
payment_history_grid varchar(max), 
suit_filed_willful_dflt integer, 
written_off_and_settled_status integer, 
write_off_status_dt date, 
responsibility_cd integer, 
portfolio_rating_type_cd varchar(10), 
write_off_am bigint, 
actual_payment_am_01 bigint, 
actual_payment_am_02 bigint, 
actual_payment_am_03 bigint, 
actual_payment_am_04 bigint, 
actual_payment_am_05 bigint, 
actual_payment_am_06 bigint, 
actual_payment_am_07 bigint, 
actual_payment_am_08 bigint, 
actual_payment_am_09 bigint, 
actual_payment_am_10 bigint, 
actual_payment_am_11 bigint, 
actual_payment_am_12 bigint, 
actual_payment_am_13 bigint, 
actual_payment_am_14 bigint, 
actual_payment_am_15 bigint, 
actual_payment_am_16 bigint, 
actual_payment_am_17 bigint, 
actual_payment_am_18 bigint, 
actual_payment_am_19 bigint, 
actual_payment_am_20 bigint, 
actual_payment_am_21 bigint, 
actual_payment_am_22 bigint, 
actual_payment_am_23 bigint, 
actual_payment_am_24 bigint, 
actual_payment_am_25 bigint, 
actual_payment_am_26 bigint, 
actual_payment_am_27 bigint, 
actual_payment_am_28 bigint, 
actual_payment_am_29 bigint, 
actual_payment_am_30 bigint, 
actual_payment_am_31 bigint, 
actual_payment_am_32 bigint, 
actual_payment_am_33 bigint, 
actual_payment_am_34 bigint, 
actual_payment_am_35 bigint, 
actual_payment_am_36 bigint, 
balance_am_01 bigint, 
balance_am_02 bigint, 
balance_am_03 bigint, 
balance_am_04 bigint, 
balance_am_05 bigint, 
balance_am_06 bigint, 
balance_am_07 bigint, 
balance_am_08 bigint, 
balance_am_09 bigint, 
balance_am_10 bigint, 
balance_am_11 bigint, 
balance_am_12 bigint, 
balance_am_13 bigint, 
balance_am_14 bigint, 
balance_am_15 bigint, 
balance_am_16 bigint, 
balance_am_17 bigint, 
balance_am_18 bigint, 
balance_am_19 bigint, 
balance_am_20 bigint, 
balance_am_21 bigint, 
balance_am_22 bigint, 
balance_am_23 bigint, 
balance_am_24 bigint, 
balance_am_25 bigint, 
balance_am_26 bigint, 
balance_am_27 bigint, 
balance_am_28 bigint, 
balance_am_29 bigint, 
balance_am_30 bigint, 
balance_am_31 bigint, 
balance_am_32 bigint, 
balance_am_33 bigint, 
balance_am_34 bigint, 
balance_am_35 bigint, 
balance_am_36 bigint, 
credit_limit_am_01 bigint, 
credit_limit_am_02 bigint, 
credit_limit_am_03 bigint, 
credit_limit_am_04 bigint, 
credit_limit_am_05 bigint, 
credit_limit_am_06 bigint, 
credit_limit_am_07 bigint, 
credit_limit_am_08 bigint, 
credit_limit_am_09 bigint, 
credit_limit_am_10 bigint, 
credit_limit_am_11 bigint, 
credit_limit_am_12 bigint, 
credit_limit_am_13 bigint, 
credit_limit_am_14 bigint, 
credit_limit_am_15 bigint, 
credit_limit_am_16 bigint, 
credit_limit_am_17 bigint, 
credit_limit_am_18 bigint, 
credit_limit_am_19 bigint, 
credit_limit_am_20 bigint, 
credit_limit_am_21 bigint, 
credit_limit_am_22 bigint, 
credit_limit_am_23 bigint, 
credit_limit_am_24 bigint, 
credit_limit_am_25 bigint, 
credit_limit_am_26 bigint, 
credit_limit_am_27 bigint, 
credit_limit_am_28 bigint, 
credit_limit_am_29 bigint, 
credit_limit_am_30 bigint, 
credit_limit_am_31 bigint, 
credit_limit_am_32 bigint, 
credit_limit_am_33 bigint, 
credit_limit_am_34 bigint, 
credit_limit_am_35 bigint, 
credit_limit_am_36 bigint, 
past_due_am_01 bigint, 
past_due_am_02 bigint, 
past_due_am_03 bigint, 
past_due_am_04 bigint, 
past_due_am_05 bigint, 
past_due_am_06 bigint, 
past_due_am_07 bigint, 
past_due_am_08 bigint, 
past_due_am_09 bigint, 
past_due_am_10 bigint, 
past_due_am_11 bigint, 
past_due_am_12 bigint, 
past_due_am_13 bigint, 
past_due_am_14 bigint, 
past_due_am_15 bigint, 
past_due_am_16 bigint, 
past_due_am_17 bigint, 
past_due_am_18 bigint, 
past_due_am_19 bigint, 
past_due_am_20 bigint, 
past_due_am_21 bigint, 
past_due_am_22 bigint, 
past_due_am_23 bigint, 
past_due_am_24 bigint, 
past_due_am_25 bigint, 
past_due_am_26 bigint, 
past_due_am_27 bigint, 
past_due_am_28 bigint, 
past_due_am_29 bigint, 
past_due_am_30 bigint, 
past_due_am_31 bigint, 
past_due_am_32 bigint, 
past_due_am_33 bigint, 
past_due_am_34 bigint, 
past_due_am_35 bigint, 
past_due_am_36 bigint, 
payment_rating_cd_01 varchar(10), 
payment_rating_cd_02 varchar(10), 
payment_rating_cd_03 varchar(10), 
payment_rating_cd_04 varchar(10), 
payment_rating_cd_05 varchar(10), 
payment_rating_cd_06 varchar(10), 
payment_rating_cd_07 varchar(10), 
payment_rating_cd_08 varchar(10), 
payment_rating_cd_09 varchar(10), 
payment_rating_cd_10 varchar(10), 
payment_rating_cd_11 varchar(10), 
payment_rating_cd_12 varchar(10), 
payment_rating_cd_13 varchar(10), 
payment_rating_cd_14 varchar(10), 
payment_rating_cd_15 varchar(10), 
payment_rating_cd_16 varchar(10), 
payment_rating_cd_17 varchar(10), 
payment_rating_cd_18 varchar(10), 
payment_rating_cd_19 varchar(10), 
payment_rating_cd_20 varchar(10), 
payment_rating_cd_21 varchar(10), 
payment_rating_cd_22 varchar(10), 
payment_rating_cd_23 varchar(10), 
payment_rating_cd_24 varchar(10), 
payment_rating_cd_25 varchar(10), 
payment_rating_cd_26 varchar(10), 
payment_rating_cd_27 varchar(10), 
payment_rating_cd_28 varchar(10), 
payment_rating_cd_29 varchar(10), 
payment_rating_cd_30 varchar(10), 
payment_rating_cd_31 varchar(10), 
payment_rating_cd_32 varchar(10), 
payment_rating_cd_33 varchar(10), 
payment_rating_cd_34 varchar(10), 
payment_rating_cd_35 varchar(10), 
payment_rating_cd_36 varchar(10), 
days_past_due_01 bigint, 
days_past_due_02 bigint, 
days_past_due_03 bigint, 
days_past_due_04 bigint, 
days_past_due_05 bigint, 
days_past_due_06 bigint, 
days_past_due_07 bigint, 
days_past_due_08 bigint, 
days_past_due_09 bigint, 
days_past_due_10 bigint, 
days_past_due_11 bigint, 
days_past_due_12 bigint, 
days_past_due_13 bigint, 
days_past_due_14 bigint, 
days_past_due_15 bigint, 
days_past_due_16 bigint, 
days_past_due_17 bigint, 
days_past_due_18 bigint, 
days_past_due_19 bigint, 
days_past_due_20 bigint, 
days_past_due_21 bigint, 
days_past_due_22 bigint, 
days_past_due_23 bigint, 
days_past_due_24 bigint, 
days_past_due_25 bigint, 
days_past_due_26 bigint, 
days_past_due_27 bigint, 
days_past_due_28 bigint, 
days_past_due_29 bigint, 
days_past_due_30 bigint, 
days_past_due_31 bigint, 
days_past_due_32 bigint, 
days_past_due_33 bigint, 
days_past_due_34 bigint, 
days_past_due_35 bigint, 
days_past_due_36 bigint ,
 inserted_at date,
 updated_at date,
filename varchar(255)

)



insert into "digital-revenue".nbu.experian_tradeline_segment(response_id ,	customer_id , 	acct_key , 	account_nb , 	m_sub_id , 	acct_type_cd , 	open_dt , 	actual_payment_am , 	asset_class_cd , 	balance_am , 	balance_dt , 	total_write_off_am_4in , 	principal_write_off_am_4in , 	tanure , 	emi , 	account_desc_cd , 	interest_rate , 	settled_am_4in , 	start_pymt_dt , 	last_reporting_pymt_dt , 	bank_name , 	closed_dt , 	credit_limit_am , 	days_past_due , 	dflt_status_dt , 	last_payment_dt , 	orig_loan_am , 	past_due_am , 	payment_history_grid , 	suit_filed_willful_dflt , 	written_off_and_settled_status , 	write_off_status_dt , 	responsibility_cd , 	portfolio_rating_type_cd , 	write_off_am , 	actual_payment_am_01 , 	actual_payment_am_02 , 	actual_payment_am_03 , 	actual_payment_am_04 , 	actual_payment_am_05 , 	actual_payment_am_06 , 	actual_payment_am_07 , 	actual_payment_am_08 , 	actual_payment_am_09 , 	actual_payment_am_10 , 	actual_payment_am_11 , 	actual_payment_am_12 , 	
actual_payment_am_13 , 	actual_payment_am_14 , 	actual_payment_am_15 , 	actual_payment_am_16 , 	actual_payment_am_17 , 	
actual_payment_am_18 , 	actual_payment_am_19 , 	actual_payment_am_20 , 	actual_payment_am_21 , 	actual_payment_am_22 , 	
actual_payment_am_23 , 	actual_payment_am_24 , 	actual_payment_am_25 , 	actual_payment_am_26 , 	actual_payment_am_27 , 	
actual_payment_am_28 , 	actual_payment_am_29 , 	actual_payment_am_30 , 	actual_payment_am_31 , 	actual_payment_am_32 , 	
actual_payment_am_33 , 	actual_payment_am_34 , 	actual_payment_am_35 , 	actual_payment_am_36 , 	balance_am_01 , 	
balance_am_02 , 	balance_am_03 , 	balance_am_04 , 	balance_am_05 , 	balance_am_06 , 	balance_am_07 , 	
balance_am_08 , 	balance_am_09 , 	balance_am_10 , 	balance_am_11 , 	balance_am_12 , 	balance_am_13 , 	
balance_am_14 , 	balance_am_15 , 	balance_am_16 , 	balance_am_17 , 	balance_am_18 , 	balance_am_19 , 
	balance_am_20 , 	balance_am_21 , 	balance_am_22 , 	balance_am_23 , 	balance_am_24 , 	balance_am_25 , 
    	balance_am_26 , 	balance_am_27 , 	balance_am_28 , 	balance_am_29 , 	balance_am_30 , 	balance_am_31 , 
        	balance_am_32 , 	balance_am_33 , 	balance_am_34 , 	balance_am_35 , 	balance_am_36 , 	credit_limit_am_01 , 
            	credit_limit_am_02 , 	credit_limit_am_03 , 	credit_limit_am_04 , 	credit_limit_am_05 , 	credit_limit_am_06 , 
                	credit_limit_am_07 , 	credit_limit_am_08 , 	credit_limit_am_09 , 	credit_limit_am_10 , 	credit_limit_am_11 , 
                    	credit_limit_am_12 , 	credit_limit_am_13 , 	credit_limit_am_14 , 	credit_limit_am_15 , 	credit_limit_am_16 , 
                        	credit_limit_am_17 , 	credit_limit_am_18 , 	credit_limit_am_19 , 	credit_limit_am_20 , 	credit_limit_am_21 , 
                            	credit_limit_am_22 , 	credit_limit_am_23 , 	credit_limit_am_24 , 	credit_limit_am_25 , 	credit_limit_am_26 , 
                                	credit_limit_am_27 , 	credit_limit_am_28 , 	credit_limit_am_29 , 	credit_limit_am_30 , 	credit_limit_am_31 , 	
                                    credit_limit_am_32 , 	credit_limit_am_33 , 	credit_limit_am_34 , 	credit_limit_am_35 , 	credit_limit_am_36 , 
                                    	past_due_am_01 , 	past_due_am_02 , 	past_due_am_03 , 	past_due_am_04 , 	past_due_am_05 , 	past_due_am_06 , 	
                                        past_due_am_07 , 	past_due_am_08 , 	past_due_am_09 , 	past_due_am_10 , 	past_due_am_11 , 	past_due_am_12 , 	past_due_am_13 , 	past_due_am_14 , 	past_due_am_15 , 	past_due_am_16 , 	past_due_am_17 , 	past_due_am_18 , 	past_due_am_19 , 	past_due_am_20 , 	past_due_am_21 , 	past_due_am_22 , 	past_due_am_23 , 	past_due_am_24 , 	past_due_am_25 , 	past_due_am_26 , 	past_due_am_27 , 	past_due_am_28 , 	past_due_am_29 , 	past_due_am_30 , 	past_due_am_31 , 	past_due_am_32 , 	past_due_am_33 , 	past_due_am_34 , 	past_due_am_35 , 	past_due_am_36 , 	payment_rating_cd_01 , 	payment_rating_cd_02 , 	payment_rating_cd_03 , 	payment_rating_cd_04 , 	payment_rating_cd_05 , 	payment_rating_cd_06 , 	payment_rating_cd_07 , 	payment_rating_cd_08 , 	payment_rating_cd_09 , 	payment_rating_cd_10 , 	payment_rating_cd_11 , 	payment_rating_cd_12 , 	payment_rating_cd_13 , 	payment_rating_cd_14 , 	payment_rating_cd_15 , 	payment_rating_cd_16 , 	payment_rating_cd_17 , 	payment_rating_cd_18 , 	payment_rating_cd_19 , 	payment_rating_cd_20 , 	payment_rating_cd_21 , 	payment_rating_cd_22 , 	payment_rating_cd_23 , 	payment_rating_cd_24 , 	payment_rating_cd_25 , 	payment_rating_cd_26 , 	payment_rating_cd_27 , 	payment_rating_cd_28 , 	payment_rating_cd_29 , 	payment_rating_cd_30 , 	payment_rating_cd_31 , 	payment_rating_cd_32 , 	payment_rating_cd_33 , 	payment_rating_cd_34 , 	payment_rating_cd_35 , 	payment_rating_cd_36 , 	days_past_due_01 , 	days_past_due_02 , 	days_past_due_03 , 	days_past_due_04 , 	days_past_due_05 , 	days_past_due_06 , 	days_past_due_07 , 	days_past_due_08 , 	days_past_due_09 , 	days_past_due_10 , 	days_past_due_11 , 	days_past_due_12 , 	days_past_due_13 , 	days_past_due_14 , 	days_past_due_15 , 	days_past_due_16 , 	days_past_due_17 , 	days_past_due_18 , 	days_past_due_19 , 	days_past_due_20 , 	days_past_due_21 , 	days_past_due_22 , 	days_past_due_23 , 	days_past_due_24 , 	days_past_due_25 , 	days_past_due_26 , 	days_past_due_27 , 	days_past_due_28 , 	days_past_due_29 , 	days_past_due_30 , 	days_past_due_31 , 	days_past_due_32 , 	days_past_due_33 , 	days_past_due_34 , 	days_past_due_35 , 	days_past_due_36  ,	 inserted_at ,	 updated_at , filename)


 select
  response_id,
 cast ( a.customer_id as  bigint ),
cast ( acct_key as  bigint ),
  account_nb  ,
  m_sub_id  ,
cast ( acct_type_cd as  integer ),
to_date ( open_dt ,  'DD/MM/YYYY' ),
cast ( actual_payment_am as  integer ),
  asset_class_cd  ,
cast ( balance_am as  integer ),
to_date ( balance_dt ,  'DD/MM/YYYY' ),
cast ( total_write_off_am_4in as  bigint ),
cast ( principal_write_off_am_4in as  bigint ),
cast ( tanure as  bigint ),
cast ( emi as  bigint ),
cast ( account_desc_cd as  bigint ),
cast ( interest_rate as  decimal(15,5) ),
cast ( settled_am_4in as  bigint ),
to_date ( start_pymt_dt ,  'DD/MM/YYYY' ),
to_date ( last_reporting_pymt_dt ,  'DD/MM/YYYY' ),
  bank_name  ,
to_date ( closed_dt ,  'DD/MM/YYYY' ),
cast ( credit_limit_am as  bigint ),
cast ( days_past_due as  integer ),
to_date ( dflt_status_dt ,  'DD/MM/YYYY' ),
to_date ( last_payment_dt ,  'DD/MM/YYYY' ),
cast ( orig_loan_am as  bigint ),
cast ( past_due_am as  bigint ),
 payment_history_grid  ,
cast ( suit_filed_willful_dflt as  integer ),
cast ( written_off_and_settled_status as  integer ),
to_date ( write_off_status_dt ,  'DD/MM/YYYY' ),
cast ( responsibility_cd as  integer ),
 portfolio_rating_type_cd  ,
cast ( write_off_am as  bigint ),
cast ( actual_payment_am_01 as  bigint ),
cast ( actual_payment_am_02 as  bigint ),
cast ( actual_payment_am_03 as  bigint ),
cast ( actual_payment_am_04 as  bigint ),
cast ( actual_payment_am_05 as  bigint ),
cast ( actual_payment_am_06 as  bigint ),
cast ( actual_payment_am_07 as  bigint ),
cast ( actual_payment_am_08 as  bigint ),
cast ( actual_payment_am_09 as  bigint ),
cast ( actual_payment_am_10 as  bigint ),
cast ( actual_payment_am_11 as  bigint ),
cast ( actual_payment_am_12 as  bigint ),
cast ( actual_payment_am_13 as  bigint ),
cast ( actual_payment_am_14 as  bigint ),
cast ( actual_payment_am_15 as  bigint ),
cast ( actual_payment_am_16 as  bigint ),
cast ( actual_payment_am_17 as  bigint ),
cast ( actual_payment_am_18 as  bigint ),
cast ( actual_payment_am_19 as  bigint ),
cast ( actual_payment_am_20 as  bigint ),
cast ( actual_payment_am_21 as  bigint ),
cast ( actual_payment_am_22 as  bigint ),
cast ( actual_payment_am_23 as  bigint ),
cast ( actual_payment_am_24 as  bigint ),
cast ( actual_payment_am_25 as  bigint ),
cast ( actual_payment_am_26 as  bigint ),
cast ( actual_payment_am_27 as  bigint ),
cast ( actual_payment_am_28 as  bigint ),
cast ( actual_payment_am_29 as  bigint ),
cast ( actual_payment_am_30 as  bigint ),
cast ( actual_payment_am_31 as  bigint ),
cast ( actual_payment_am_32 as  bigint ),
cast ( actual_payment_am_33 as  bigint ),
cast ( actual_payment_am_34 as  bigint ),
cast ( actual_payment_am_35 as  bigint ),
cast ( actual_payment_am_36 as  bigint ),
cast ( balance_am_01 as  bigint ),
cast ( balance_am_02 as  bigint ),
cast ( balance_am_03 as  bigint ),
cast ( balance_am_04 as  bigint ),
cast ( balance_am_05 as  bigint ),
cast ( balance_am_06 as  bigint ),
cast ( balance_am_07 as  bigint ),
cast ( balance_am_08 as  bigint ),
cast ( balance_am_09 as  bigint ),
cast ( balance_am_10 as  bigint ),
cast ( balance_am_11 as  bigint ),
cast ( balance_am_12 as  bigint ),
cast ( balance_am_13 as  bigint ),
cast ( balance_am_14 as  bigint ),
cast ( balance_am_15 as  bigint ),
cast ( balance_am_16 as  bigint ),
cast ( balance_am_17 as  bigint ),
cast ( balance_am_18 as  bigint ),
cast ( balance_am_19 as  bigint ),
cast ( balance_am_20 as  bigint ),
cast ( balance_am_21 as  bigint ),
cast ( balance_am_22 as  bigint ),
cast ( balance_am_23 as  bigint ),
cast ( balance_am_24 as  bigint ),
cast ( balance_am_25 as  bigint ),
cast ( balance_am_26 as  bigint ),
cast ( balance_am_27 as  bigint ),
cast ( balance_am_28 as  bigint ),
cast ( balance_am_29 as  bigint ),
cast ( balance_am_30 as  bigint ),
cast ( balance_am_31 as  bigint ),
cast ( balance_am_32 as  bigint ),
cast ( balance_am_33 as  bigint ),
cast ( balance_am_34 as  bigint ),
cast ( balance_am_35 as  bigint ),
cast ( balance_am_36 as  bigint ),
cast ( credit_limit_am_01 as  bigint ),
cast ( credit_limit_am_02 as  bigint ),
cast ( credit_limit_am_03 as  bigint ),
cast ( credit_limit_am_04 as  bigint ),
cast ( credit_limit_am_05 as  bigint ),
cast ( credit_limit_am_06 as  bigint ),
cast ( credit_limit_am_07 as  bigint ),
cast ( credit_limit_am_08 as  bigint ),
cast ( credit_limit_am_09 as  bigint ),
cast ( credit_limit_am_10 as  bigint ),
cast ( credit_limit_am_11 as  bigint ),
cast ( credit_limit_am_12 as  bigint ),
cast ( credit_limit_am_13 as  bigint ),
cast ( credit_limit_am_14 as  bigint ),
cast ( credit_limit_am_15 as  bigint ),
cast ( credit_limit_am_16 as  bigint ),
cast ( credit_limit_am_17 as  bigint ),
cast ( credit_limit_am_18 as  bigint ),
cast ( credit_limit_am_19 as  bigint ),
cast ( credit_limit_am_20 as  bigint ),
cast ( credit_limit_am_21 as  bigint ),
cast ( credit_limit_am_22 as  bigint ),
cast ( credit_limit_am_23 as  bigint ),
cast ( credit_limit_am_24 as  bigint ),
cast ( credit_limit_am_25 as  bigint ),
cast ( credit_limit_am_26 as  bigint ),
cast ( credit_limit_am_27 as  bigint ),
cast ( credit_limit_am_28 as  bigint ),
cast ( credit_limit_am_29 as  bigint ),
cast ( credit_limit_am_30 as  bigint ),
cast ( credit_limit_am_31 as  bigint ),
cast ( credit_limit_am_32 as  bigint ),
cast ( credit_limit_am_33 as  bigint ),
cast ( credit_limit_am_34 as  bigint ),
cast ( credit_limit_am_35 as  bigint ),
cast ( credit_limit_am_36 as  bigint ),
cast ( past_due_am_01 as  bigint ),
cast ( past_due_am_02 as  bigint ),
cast ( past_due_am_03 as  bigint ),
cast ( past_due_am_04 as  bigint ),
cast ( past_due_am_05 as  bigint ),
cast ( past_due_am_06 as  bigint ),
cast ( past_due_am_07 as  bigint ),
cast ( past_due_am_08 as  bigint ),
cast ( past_due_am_09 as  bigint ),
cast ( past_due_am_10 as  bigint ),
cast ( past_due_am_11 as  bigint ),
cast ( past_due_am_12 as  bigint ),
cast ( past_due_am_13 as  bigint ),
cast ( past_due_am_14 as  bigint ),
cast ( past_due_am_15 as  bigint ),
cast ( past_due_am_16 as  bigint ),
cast ( past_due_am_17 as  bigint ),
cast ( past_due_am_18 as  bigint ),
cast ( past_due_am_19 as  bigint ),
cast ( past_due_am_20 as  bigint ),
cast ( past_due_am_21 as  bigint ),
cast ( past_due_am_22 as  bigint ),
cast ( past_due_am_23 as  bigint ),
cast ( past_due_am_24 as  bigint ),
cast ( past_due_am_25 as  bigint ),
cast ( past_due_am_26 as  bigint ),
cast ( past_due_am_27 as  bigint ),
cast ( past_due_am_28 as  bigint ),
cast ( past_due_am_29 as  bigint ),
cast ( past_due_am_30 as  bigint ),
cast ( past_due_am_31 as  bigint ),
cast ( past_due_am_32 as  bigint ),
cast ( past_due_am_33 as  bigint ),
cast ( past_due_am_34 as  bigint ),
cast ( past_due_am_35 as  bigint ),
cast ( past_due_am_36 as  bigint ),
cast ( payment_rating_cd_01 as  varchar(10) ),
cast ( payment_rating_cd_02 as  varchar(10) ),
cast ( payment_rating_cd_03 as  varchar(10) ),
cast ( payment_rating_cd_04 as  varchar(10) ),
cast ( payment_rating_cd_05 as  varchar(10) ),
cast ( payment_rating_cd_06 as  varchar(10) ),
cast ( payment_rating_cd_07 as  varchar(10) ),
cast ( payment_rating_cd_08 as  varchar(10) ),
cast ( payment_rating_cd_09 as  varchar(10) ),
cast ( payment_rating_cd_10 as  varchar(10) ),
cast ( payment_rating_cd_11 as  varchar(10) ),
cast ( payment_rating_cd_12 as  varchar(10) ),
cast ( payment_rating_cd_13 as  varchar(10) ),
cast ( payment_rating_cd_14 as  varchar(10) ),
cast ( payment_rating_cd_15 as  varchar(10) ),
cast ( payment_rating_cd_16 as  varchar(10) ),
cast ( payment_rating_cd_17 as  varchar(10) ),
cast ( payment_rating_cd_18 as  varchar(10) ),
cast ( payment_rating_cd_19 as  varchar(10) ),
cast ( payment_rating_cd_20 as  varchar(10) ),
cast ( payment_rating_cd_21 as  varchar(10) ),
cast ( payment_rating_cd_22 as  varchar(10) ),
cast ( payment_rating_cd_23 as  varchar(10) ),
cast ( payment_rating_cd_24 as  varchar(10) ),
cast ( payment_rating_cd_25 as  varchar(10) ),
cast ( payment_rating_cd_26 as  varchar(10) ),
cast ( payment_rating_cd_27 as  varchar(10) ),
cast ( payment_rating_cd_28 as  varchar(10) ),
cast ( payment_rating_cd_29 as  varchar(10) ),
cast ( payment_rating_cd_30 as  varchar(10) ),
cast ( payment_rating_cd_31 as  varchar(10) ),
cast ( payment_rating_cd_32 as  varchar(10) ),
cast ( payment_rating_cd_33 as  varchar(10) ),
cast ( payment_rating_cd_34 as  varchar(10) ),
cast ( payment_rating_cd_35 as  varchar(10) ),
cast ( payment_rating_cd_36 as  varchar(10) ),
cast ( days_past_due_01 as  bigint ),
cast ( days_past_due_02 as  bigint ),
cast ( days_past_due_03 as  bigint ),
cast ( days_past_due_04 as  bigint ),
cast ( days_past_due_05 as  bigint ),
cast ( days_past_due_06 as  bigint ),
cast ( days_past_due_07 as  bigint ),
cast ( days_past_due_08 as  bigint ),
cast ( days_past_due_09 as  bigint ),
cast ( days_past_due_10 as  bigint ),
cast ( days_past_due_11 as  bigint ),
cast ( days_past_due_12 as  bigint ),
cast ( days_past_due_13 as  bigint ),
cast ( days_past_due_14 as  bigint ),
cast ( days_past_due_15 as  bigint ),
cast ( days_past_due_16 as  bigint ),
cast ( days_past_due_17 as  bigint ),
cast ( days_past_due_18 as  bigint ),
cast ( days_past_due_19 as  bigint ),
cast ( days_past_due_20 as  bigint ),
cast ( days_past_due_21 as  bigint ),
cast ( days_past_due_22 as  bigint ),
cast ( days_past_due_23 as  bigint ),
cast ( days_past_due_24 as  bigint ),
cast ( days_past_due_25 as  bigint ),
cast ( days_past_due_26 as  bigint ),
cast ( days_past_due_27 as  bigint ),
cast ( days_past_due_28 as  bigint ),
cast ( days_past_due_29 as  bigint ),
cast ( days_past_due_30 as  bigint ),
cast ( days_past_due_31 as  bigint ),
cast ( days_past_due_32 as  bigint ),
cast ( days_past_due_33 as  bigint ),
cast ( days_past_due_34 as  bigint ),
cast ( days_past_due_35 as  bigint ),
cast ( days_past_due_36 as  bigint ),getdate(),getdate(),'scrub_2023-12-05' 
from nbu. stg_experian_tradeline_segment a left join nbu.experian_master_table b on (a.customer_id = b.customer_id)

select * from nbu.experian_trade_line_segment